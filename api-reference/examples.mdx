---
title: 'Examples'
description: 'A few examples of scripts'
---

  <CodeGroup>
    ```javascript Node.JS
import axios from 'axios';
import FormData from 'form-data';
import fs from 'fs';
import path from 'path';

const API_ENDPOINT = 'http://api.autocaption.io/v1'
const API_KEY = 'YOUR_API_KEY'

const videoName = 'video.mp4'
const videoLang = 'fr'
const videoPath = path.join('./', videoName);

const axiosInstance = axios.create({
    baseURL: API_ENDPOINT
});

axiosInstance.defaults.headers.common['x-api-key'] = API_KEY;

const video = fs.createReadStream(videoPath);

// Get signed url to upload video
const getSignedUrlData = async () => {
    return axiosInstance.get(`/signedUrl?file=${videoName}`).then(res => res.data);
}

// Upload video to signed url
const uploadVideo = async (url, fields) => {
    const formData = new FormData();
    for (const [key, value] of Object.entries(fields)) {
        formData.append(key, value);
    }
    formData.append('file', video);
    await axios.post(url, formData, {
        headers: {
            'Content-Type': `multipart/form-data; boundary=${formData._boundary}`
        }
    }).catch(err => console.log(err));
}

// Transcript video
const transcriptVideo = async (fileKey, lang) => {
    return axiosInstance.post('/transcript', {
        input: fileKey,
        language: lang
    }).then(res => res.data);
}

// Get transcript status
const getTranscriptStatus = async (jobId) => {
    return axiosInstance.get(`/transcript/${jobId}`).then(res => res.data).catch(err => err.response.data);
}

// Get template by id
const getTemplateById = async (id) => {
    return axiosInstance.get(`/templates/${id}`).then(res => res.data);
}

// Generate video
const generateVideo = async (file, config, words) => {
    return axiosInstance.post('/generate', {
        input: file,
        config,
        words
    }).then(res => res.data);
}

const main = async () => {
    try {
        const { file, url, fields } = await getSignedUrlData();
        await uploadVideo(url, fields);
        const { job_id } = await transcriptVideo(file, videoLang);

        // Initial check without delay
        let transcriptResponse = await getTranscriptStatus(job_id);

        // Loop until the transcript is ready or an error occurs
        while (transcriptResponse.status !== 'COMPLETED') {
            if (transcriptResponse.status == 'FAILED') {
                throw new Error('Transcription failed'); // Throws an error to exit the loop and catch block
            }
            await new Promise(resolve => setTimeout(resolve, 5000)); // Wait for 5 seconds
            transcriptResponse = await getTranscriptStatus(job_id); // Update the response
        }

        // Get the template DEFAULT
        const { config } = await getTemplateById('0');

        // Generate the video and wait the download url - Can take a few minutes
        const { download_url } = await generateVideo(file, config, transcriptResponse.words);
        console.log(download_url);
    } catch (error) {
        console.error("An error occurred:", error);
    }
};

main();
```
    ```python Python
import requests
import os
from requests_toolbelt.multipart.encoder import MultipartEncoder

API_ENDPOINT = 'http://api.autocaption.io/v1'
API_KEY = 'YOUR_API_KEY'

video_name = 'video.mp4'
video_lang = 'fr'
video_path = os.path.join('./', video_name)

session = requests.Session()
session.headers.update({'x-api-key': API_KEY})

def get_signed_url_data():
    response = session.get(f'{API_ENDPOINT}/signedUrl?file={video_name}')
    return response.json()

def upload_video(url, fields):
    with open(video_path, 'rb') as video_file:
        fields['file'] = ('filename', video_file, 'video/mp4')
        m = MultipartEncoder(fields=fields)
        headers = {'Content-Type': m.content_type}
        response = requests.post(url, data=m, headers=headers)
        if response.status_code != 200:
            raise Exception("Upload failed")

def transcript_video(file_key, lang):
    response = session.post(f'{API_ENDPOINT}/transcript', json={
        'input': file_key,
        'language': lang
    })
    return response.json()

def get_transcript_status(job_id):
    response = session.get(f'{API_ENDPOINT}/transcript/{job_id}')
    if response.status_code != 200:
        return response.json()
    return response.json()

def get_template_by_id(template_id):
    response = session.get(f'{API_ENDPOINT}/templates/{template_id}')
    return response.json()

def generate_video(file, config, words):
    response = session.post(f'{API_ENDPOINT}/generate', json={
        'input': file,
        'config': config,
        'words': words
    })
    return response.json()

def main():
    try:
        signed_url_data = get_signed_url_data()
        file, url, fields = signed_url_data['file'], signed_url_data['url'], signed_url_data['fields']
        upload_video(url, fields)
        transcript_response = transcript_video(file, video_lang)
        job_id = transcript_response['job_id']

        # Initial check without delay
        transcript_status = get_transcript_status(job_id)

        # Loop until the transcript is ready or an error occurs
        while transcript_status['status'] != 'COMPLETED':
            if 'error' in transcript_status:
                raise Exception(transcript_status['error'])
            # Wait for 5 seconds
            time.sleep(5)
            transcript_status = get_transcript_status(job_id)

        # Get the template DEFAULT
        template_response = get_template_by_id('0')
        config = template_response['config']

        # Generate the video and wait for the download url - Can take a few minutes
        generate_response = generate_video(file, config, transcript_status['words'])
        download_url = generate_response['download_url']
        print(download_url)
    except Exception as error:
        print(f"An error occurred: {error}")

if __name__ == '__main__':
    main()
```
    ```csharp C#
    using System;
    using System.IO;
    using System.Net.Http;
    using System.Threading.Tasks;
    using Newtonsoft.Json; // Make sure to add Newtonsoft.Json through NuGet

    class Program
    {
        private static readonly string ApiEndpoint = "http://api.autocaption.io/v1";
        private static readonly string ApiKey = "YOUR_API_KEY";
        private static readonly string VideoName = "video.mp4";
        private static readonly string VideoLang = "fr";
        private static readonly string VideoPath = Path.Combine("./", VideoName);

        static async Task Main(string[] args)
        {
            try
            {
                using (var httpClient = new HttpClient())
                {
                    httpClient.BaseAddress = new Uri(ApiEndpoint);
                    httpClient.DefaultRequestHeaders.Add("x-api-key", ApiKey);

                    var signedUrlData = await GetSignedUrlData(httpClient);
                    await UploadVideo(httpClient, signedUrlData.Url, signedUrlData.Fields);
                    var transcriptResponse = await TranscriptVideo(httpClient, signedUrlData.File, VideoLang);
                    var jobId = transcriptResponse.JobId;

                    // Initial check without delay
                    var transcriptStatus = await GetTranscriptStatus(httpClient, jobId);

                    // Loop until the transcript is ready or an error occurs
                    while (transcriptStatus.Status != "COMPLETED")
                    {
                        if (transcriptStatus.Status == 'FAILED')
                        {
                            throw new Exception('Transcription failed');
                        }
                        await Task.Delay(5000); // Wait for 5 seconds
                        transcriptStatus = await GetTranscriptStatus(httpClient, jobId);
                    }

                    // Get the template DEFAULT
                    var templateResponse = await GetTemplateById(httpClient, "0");

                    // Generate the video and wait for the download url - Can take a few minutes
                    var generateResponse = await GenerateVideo(httpClient, signedUrlData.File, templateResponse.Config, transcriptStatus.Words);
                    Console.WriteLine(generateResponse.DownloadUrl);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
            }
        }

        private static async Task<dynamic> GetSignedUrlData(HttpClient httpClient)
        {
            var response = await httpClient.GetAsync($"/signedUrl?file={VideoName}");
            response.EnsureSuccessStatusCode();
            var content = await response.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(content);
        }

        private static async Task UploadVideo(HttpClient httpClient, string url, dynamic fields)
        {
            using (var content = new MultipartFormDataContent())
            {
                foreach (var field in fields)
                {
                    content.Add(new StringContent(field.Value.ToString()), field.Key);
                }

                using (var fileStream = new FileStream(VideoPath, FileMode.Open, FileAccess.Read))
                {
                    content.Add(new StreamContent(fileStream), "file", VideoName);
                    var response = await httpClient.PostAsync(url, content);
                    response.EnsureSuccessStatusCode();
                }
            }
        }

        private static async Task<dynamic> TranscriptVideo(HttpClient httpClient, string fileKey, string lang)
        {
            var response = await httpClient.PostAsync("/transcript", new StringContent(JsonConvert.SerializeObject(new { input = fileKey, language = lang }), System.Text.Encoding.UTF8, "application/json"));
            response.EnsureSuccessStatusCode();
            var content = await response.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(content);
        }

        private static async Task<dynamic> GetTranscriptStatus(HttpClient httpClient, string jobId)
        {
            var response = await httpClient.GetAsync($"/transcript/{jobId}");
            var content = await response.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(content);
        }

        private static async Task<dynamic> GetTemplateById(HttpClient httpClient, string id)
        {
            var response = await httpClient.GetAsync($"/templates/{id}");
            response.EnsureSuccessStatusCode();
            var content = await response.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(content);
        }

        private static async Task<dynamic> GenerateVideo(HttpClient httpClient, string file, dynamic config, dynamic words)
        {
            var response = await httpClient.PostAsync("/generate", new StringContent(JsonConvert.SerializeObject(new { input = file, config, words }), System.Text.Encoding.UTF8, "application/json"));
            response.EnsureSuccessStatusCode();
            var content = await response.Content.ReadAsStringAsync();
            return JsonConvert.DeserializeObject(content);
        }
    }    
```
  </CodeGroup>